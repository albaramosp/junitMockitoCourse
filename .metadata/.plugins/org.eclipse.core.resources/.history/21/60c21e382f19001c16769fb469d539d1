package mockito;

import static org.junit.jupiter.api.Assertions.*;
import static org.mockito.Mockito.mock;
import static org.mockito.Mockito.when;

import org.junit.jupiter.api.AfterEach;
import org.junit.jupiter.api.BeforeEach;
import org.junit.jupiter.api.Test;
import org.mockito.Mock;
import org.mockito.MockitoAnnotations;

class MessengerTest {

	private static final String RANDOM_EMAIL = "someone@example.com";
	private static final String RANDOM_MESSAGE = "Random message";

	@Mock
	private TemplateEngine templateEngineMock;
	@Mock
	private MailServer mailServerMock;
	
	private AutoCloseable closeable;
	
	@BeforeEach
	void setUp() {
		//templateEngineMock = mock(TemplateEngine.class);
		//MockitoAnnotations.initMocks(this);
		closeable = MockitoAnnotations.openMocks(this);
	}
	
	@AfterEach
	void setOff() throws Exception {
		closeable.close();
	}

	@Test
	void shouldSendMessage() {
		var client = new Client(RANDOM_EMAIL);
		var template = new Template();
		
		when(templateEngineMock.prepareMessage(client, template)).thenReturn(RANDOM_MESSAGE);
	}

}
